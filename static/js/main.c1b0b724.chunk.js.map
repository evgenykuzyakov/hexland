{"version":3,"sources":["pages/Home.js","App.js","index.js"],"names":["lastMousePos","Sq3","Math","sqrt","DxA","DxB","drawHex","ctx","cx","cy","side","color","fillStyle","beginPath","moveTo","lineTo","fill","HomePage","props","canvasEl","useRef","useState","setCtx","a","b","zoom","view","setView","mouseAb","setMouseAb","refresh","useCallback","maxA","maxB","db","da","oa","ob","a1","floor","a2","ceil","b1","b2","clearRect","font","textAlign","textBaseline","ia","fillText","dist","na","nb","ta","trunc","tb","best","minD","i","j","d","useEffect","current","getContext","addEventListener","e","x","clientX","y","clientY","rect","target","getBoundingClientRect","dx","width","height","buttons","preventDefault","mb","ma","newZoom","max","deltaY","resize","pixelRatio","window","devicePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","scale","v","Object","assign","className","ref","NearConfig","location","hostname","networkId","nodeUrl","archivalNodeUrl","contractName","walletUrl","App","_near","lsKey","lsKeyRecentCards","state","connected","isNavCollapsed","account","requests","recentCards","ls","get","_initNear","then","setState","signedIn","accountId","signedAccountId","keyStore","nearAPI","BrowserLocalStorageKeyStore","deps","near","this","walletConnection","getAccountId","contract","viewMethods","changeMethods","requestSignIn","signOut","_accountId","c","slice","r","push","cardId","index","indexOf","splice","unshift","set","alert","logOut","passProps","updateState","s","popRequest","addRequest","addRecentCard","refreshAllowance","header","onClick","role","aria-hidden","basename","process","to","title","type","data-bs-toggle","data-bs-target","aria-controls","aria-expanded","aria-label","id","aria-current","href","data-ribbon","exact","path","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.c1b0b724.chunk.js","sourcesContent":["import \"./Home.scss\";\nimport React, {useCallback, useEffect, useRef, useState} from 'react';\n\nconst Width = 640;\nconst Height = 480\n\nlet lastMousePos = null;\nconst Sq3 = Math.sqrt(3.0) / 2;\nconst DxA = Sq3 * 2;\nconst DyA = 0;\nconst DxB = Sq3;\nconst DyB = 1.5;\n\n\nfunction drawHex(ctx, cx, cy, side, color) {\n  // `rgb(${((i * 16 % 256) + 256) % 256}, ${((j * 16 % 256) + 256) % 256},${(((i + 13 + j * 17) % 256) + 256) % 256})`\n  ctx.fillStyle = color;\n  ctx.beginPath();\n  ctx.moveTo(cx, cy - side);\n  ctx.lineTo(cx - Sq3 * side, cy - side / 2);\n  ctx.lineTo(cx - Sq3 * side, cy + side / 2);\n  ctx.lineTo(cx, cy + side);\n  ctx.lineTo( cx + Sq3 * side, cy + side / 2);\n  ctx.lineTo(cx + Sq3 * side, cy - side / 2);\n  ctx.fill();\n}\n\nfunction HomePage(props) {\n  const canvasEl = useRef(null);\n  const [ctx, setCtx] = useState(null);\n  const [view, setView] = useState({\n    a: 0,\n    b: 0,\n    zoom: 32,\n  });\n  const [mouseAb, setMouseAb] = useState({a: 0, b: 0});\n\n  const refresh = useCallback(() => {\n    let width = Width;\n    let height = Height;\n    let maxA = width / view.zoom / DxA;\n    let maxB = height / view.zoom / DyB;\n\n    const db = height / view.zoom / DyB / 2;\n    const da = (width / view.zoom / 2 - db * DxB) / DxA;\n\n    const oa = view.a - da;\n    const ob = view.b - db;\n\n    let a1 = Math.floor(oa);\n    let a2 = Math.ceil(oa + maxA);\n    let b1 = Math.floor(ob);\n    let b2 = Math.floor(ob + maxB + 1);\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.font = `${view.zoom / 3}px serif`;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    for (let b = b1; b <= b2; ++b) {\n      for (let ia = a1; ia <= a2; ++ia) {\n        const a = ia - Math.floor((b - b1) / 2);\n        const cy = ((b - ob) * DyB + (a - oa) * DyA) * view.zoom;\n        const cx = ((b - ob) * DxB + (a - oa) * DxA) * view.zoom;\n        drawHex(\n          ctx,\n          cx,\n          cy,\n          view.zoom,\n          `rgb(${((a * 16 % 256) + 256) % 256}, ${((b * 16 % 256) + 256) % 256},${(((a + 13 + b * 17) % 256) + 256) % 256})`\n        );\n        // ctx.fillRect((j - offsetLeft) * view.zoom, (i - offsetTop) * view.zoom,  view.zoom,  view.zoom);\n        ctx.fillStyle = 'white';\n        ctx.fillText(`${a}, ${b}`, cx, cy);\n      }\n    }\n\n    if (mouseAb) {\n      let a = view.a + mouseAb.a / view.zoom;\n      let b = view.b + mouseAb.b / view.zoom;\n\n      function dist(na, nb) {\n        const cy = ((nb - b) * DyB + (na - a) * DyA);\n        const cx = ((nb - b) * DxB + (na - a) * DxA);\n        return cx * cx + cy * cy;\n      }\n\n      const ta = Math.trunc(a);\n      const tb = Math.trunc(b);\n      let best = null;\n      let minD = 10;\n\n      for (let i = -1; i < 2 ; ++i) {\n        for (let j = -1; j < 2; ++j) {\n          const a = ta + i;\n          const b = tb + j;\n          const d = dist(a, b);\n          if (d < minD + 1e-9) {\n            best = {a, b};\n            minD = d;\n          }\n        }\n      }\n\n      a = best.a;\n      b = best.b;\n\n      const cy = ((b - ob) * DyB + (a - oa) * DyA) * view.zoom;\n      const cx = ((b - ob) * DxB + (a - oa) * DxA) * view.zoom;\n      drawHex(\n        ctx,\n        cx,\n        cy,\n        view.zoom,\n        'rgba(0, 0, 0, 0.25)'\n      );\n    }\n\n  }, [ctx, view, mouseAb])\n\n  useEffect(() => {\n    if (ctx) {\n      refresh();\n    }\n  }, [mouseAb, view, ctx, refresh])\n\n  useEffect(() => {\n    if (canvasEl.current) {\n      const ctx = canvasEl.current.getContext('2d');\n      setCtx(ctx);\n      canvasEl.current.addEventListener('mousemove', (e) => {\n        const x = e.clientX;\n        const y = e.clientY;\n        const rect = e.target.getBoundingClientRect();\n        const dx = ((e.clientX - rect.x) / rect.width - 0.5) * Width;\n        const dy = ((e.clientY - rect.y) / rect.height - 0.5) * Height;\n        const b = dy / DyB;\n        const a = (dx - b * DxB) / DxA;\n        setMouseAb({\n          a, b\n        })\n        if (lastMousePos) {\n          const dx = (x - lastMousePos.x) / rect.width * Width;\n          const dy = (y - lastMousePos.y) / rect.height * Height;\n          const db = dy / DyB;\n          const da = (dx - db * DxB) / DxA;\n          setView((view) => {\n            return {\n              a: view.a - da / view.zoom,\n              b: view.b - db / view.zoom,\n              zoom: view.zoom,\n            }\n          })\n        }\n        if (e.buttons & 1) {\n          lastMousePos = {x, y};\n        } else {\n          lastMousePos = null;\n        }\n      });\n\n      canvasEl.current.addEventListener('wheel', (e) => {\n        e.preventDefault();\n        const rect = e.target.getBoundingClientRect();\n        const dx = ((e.clientX - rect.x) / rect.width - 0.5) * Width;\n        const dy = ((e.clientY - rect.y) / rect.height - 0.5) * Height;\n        const mb = dy / DyB;\n        const ma = (dx - mb * DxB) / DxA;\n        setView((view) => {\n          const newZoom = Math.max(8, view.zoom - e.deltaY * 0.1);\n          const oa = view.a + ma / view.zoom;\n          const ob = view.b + mb / view.zoom;\n          const va = oa - ma / newZoom;\n          const vb = ob - mb / newZoom;\n\n          return {\n            a: va,\n            b: vb,\n            zoom: newZoom,\n          }\n        })\n      });\n\n      const resize = () => {\n        const dpr = window.devicePixelRatio || 1;\n        const bsr = ctx.webkitBackingStorePixelRatio ||\n          ctx.mozBackingStorePixelRatio ||\n          ctx.msBackingStorePixelRatio ||\n          ctx.oBackingStorePixelRatio ||\n          ctx.backingStorePixelRatio || 1;\n\n        const pixelRatio = dpr / bsr;\n        const rect = canvasEl.current.getBoundingClientRect();\n        canvasEl.current.width  = rect.width * pixelRatio;\n        canvasEl.current.height = rect.height * pixelRatio;\n        ctx.scale(canvasEl.current.width / Width, canvasEl.current.height / Height);\n        setView((v) => Object.assign({}, v));\n      };\n\n      window.addEventListener('resize', resize);\n\n      resize();\n\n    }\n  }, [canvasEl])\n\n  return (\n    <div>\n      <div className=\"container\">\n        <div className=\"row justify-content-md-center mb-3\">\n          <div>\n            {view.a} {view.b} {view.zoom}\n          </div>\n          <canvas\n            ref={canvasEl}\n            className=\"canvas\"\n            width={640}\n            height={480}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default HomePage;\n","import React from 'react';\nimport \"error-polyfill\";\nimport 'bootstrap/dist/js/bootstrap.bundle';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport \"./App.scss\";\nimport './gh-fork-ribbon.css';\nimport * as nearAPI from 'near-api-js'\nimport HomePage from \"./pages/Home\";\nimport {HashRouter as Router, Link, Route, Switch} from 'react-router-dom'\nimport ls from \"local-storage\";\n\nconst IsMainnet = window.location.hostname === \"berry.cards\";\nconst TestNearConfig = {\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  archivalNodeUrl: 'https://rpc.testnet.internal.near.org',\n  contractName: 'dev-1614796345972-8721304',\n  walletUrl: 'https://wallet.testnet.near.org',\n};\nconst MainNearConfig = {\n  networkId: 'mainnet',\n  nodeUrl: 'https://rpc.mainnet.near.org',\n  archivalNodeUrl: 'https://rpc.mainnet.internal.near.org',\n  contractName: 'cards.berryclub.ek.near',\n  walletUrl: 'https://wallet.near.org',\n};\n\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this._near = {};\n\n    this._near.lsKey = NearConfig.contractName + ':v01:';\n    this._near.lsKeyRecentCards = this._near.lsKey + \"recentCards\";\n\n    this.state = {\n      connected: false,\n      isNavCollapsed: true,\n      account: null,\n      requests: null,\n      recentCards: ls.get(this._near.lsKeyRecentCards) || [],\n    };\n\n    this._initNear().then(() => {\n      this.setState({\n        signedIn: !!this._near.accountId,\n        signedAccountId: this._near.accountId,\n        connected: true,\n      });\n    });\n  }\n\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(Object.assign({deps: {keyStore}}, NearConfig));\n    this._near.keyStore = keyStore;\n    this._near.near = near;\n\n    this._near.walletConnection = new nearAPI.WalletConnection(near, NearConfig.contractName);\n    this._near.accountId = this._near.walletConnection.getAccountId();\n\n    this._near.account = this._near.walletConnection.account();\n    this._near.contract = new nearAPI.Contract(this._near.account, NearConfig.contractName, {\n      viewMethods: ['get_account', 'get_num_accounts', 'get_accounts', 'get_num_cards', 'get_top', 'get_rating', 'get_trade_data', 'get_card_info', 'get_account_cards'],\n      changeMethods: ['register_account', 'vote', 'buy_card'],\n    });\n\n  }\n\n  async requestSignIn(e) {\n    e && e.preventDefault();\n    const appTitle = 'Berry Cards';\n    await this._near.walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    )\n    return false;\n  }\n\n  async logOut() {\n    this._near.walletConnection.signOut();\n    this._near.accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      signedAccountId: this._accountId,\n    })\n  }\n\n  popRequest(c) {\n    const requests = this.state.requests.slice(1);\n    this.setState({\n      requests,\n    }, c);\n  }\n\n  addRequest(r, c) {\n    const requests = this.state.requests.slice(0);\n    requests.push(r);\n    this.setState({\n      requests,\n    }, c);\n  }\n\n  addRecentCard(cardId) {\n    let recentCards = this.state.recentCards.slice(0);\n    const index = recentCards.indexOf(cardId);\n    if (index !== -1) {\n      recentCards.splice(index, 1);\n    }\n    recentCards.unshift(cardId);\n    recentCards = recentCards.slice(0, 5);\n    ls.set(this._near.lsKeyRecentCards, recentCards);\n    this.setState({\n      recentCards\n    })\n  }\n\n  async refreshAllowance() {\n    alert(\"You're out of access key allowance. Need sign in again to refresh it\");\n    await this.logOut();\n    await this.requestSignIn();\n  }\n\n  render() {\n    const passProps = {\n      _near: this._near,\n      updateState: (s, c) => this.setState(s, c),\n      popRequest: (c) => this.popRequest(c),\n      addRequest: (r, c) => this.addRequest(r, c),\n      addRecentCard: (cardId) => this.addRecentCard(cardId),\n      refreshAllowance: () => this.refreshAllowance(),\n      ...this.state\n    };\n    const header = !this.state.connected ? (\n      <div>Connecting... <span className=\"spinner-grow spinner-grow-sm\" role=\"status\" aria-hidden=\"true\"></span></div>\n    ) : (this.state.signedIn ? (\n      <div>\n        <button\n          className=\"btn btn-outline-secondary\"\n          onClick={() => this.logOut()}>Sign out ({this.state.signedAccountId})</button>\n      </div>\n    ) : (\n      <div>\n        <button\n          className=\"btn btn-primary\"\n          onClick={(e) => this.requestSignIn(e)}>Sign in with NEAR Wallet</button>\n      </div>\n    ));\n\n    return (\n      <div className=\"App\">\n        <Router basename={process.env.PUBLIC_URL}>\n          <nav className=\"navbar navbar-expand-lg navbar-light bg-light mb-3\">\n            <div className=\"container-fluid\">\n              <Link className=\"navbar-brand\" to=\"/\" title=\"NEAR.fm\">\n                [BETA] Berry Cards\n              </Link>\n              <button className=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\"\n                      data-bs-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\"\n                      aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                <span className=\"navbar-toggler-icon\"></span>\n              </button>\n              <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" aria-current=\"page\" to=\"/\">Home</Link>\n                  </li>\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\" to=\"/discover\">Discover</Link>\n                    </li>\n                  )}\n                  {this.state.signedIn && (\n                    <li className=\"nav-item\">\n                      <Link className=\"nav-link\" aria-current=\"page\"\n                            to={`/a/${this.state.signedAccountId}`}>Profile</Link>\n                    </li>\n                  )}\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" aria-current=\"page\" to=\"/stats\">Stats</Link>\n                  </li>\n                </ul>\n                <form className=\"d-flex\">\n                  {header}\n                </form>\n              </div>\n            </div>\n          </nav>\n\n          <a className=\"github-fork-ribbon right-bottom fixed\" href=\"https://github.com/evgenykuzyakov/berry-hot\" data-ribbon=\"Fork me on GitHub\"\n             title=\"Fork me on GitHub\">Fork me on GitHub</a>\n\n          <Switch>\n            <Route exact path={\"/\"}>\n              <HomePage {...passProps}/>\n            </Route>\n          </Switch>\n        </Router>\n      </div>\n    )\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}