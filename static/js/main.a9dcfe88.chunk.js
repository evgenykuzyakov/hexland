(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{116:function(e,t,n){},117:function(e,t,n){},122:function(e,t){},130:function(e,t){},146:function(e,t){},148:function(e,t){},177:function(e,t,n){},178:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(84),c=n.n(o),i=(n(99),n(92)),s=n(0),u=n.n(s),l=n(14),d=n(85),f=n(86),h=n(93),v=n(90),m=(n(47),n(116),n(117),n(15)),p=n(45),b=n.n(p),g=n(87),_={networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",archivalNodeUrl:"https://rpc.mainnet.internal.near.org",contractName:"dev-1614796345972-8721304",walletUrl:"https://wallet.testnet.near.org"},w=function(e){Object(h.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e))._near={},a._near.lsKey=_.contractName+":v01:",a._near.lsKeyRecentCards=a._near.lsKey+"recentCards",a.state={connected:!1,isNavCollapsed:!0,account:null,requests:null,recentCards:b.a.get(a._near.lsKeyRecentCards)||[]},a._initNear().then((function(){a.setState({signedIn:!!a._near.accountId,signedAccountId:a._near.accountId,connected:!0})})),a}return Object(f.a)(n,[{key:"_initNear",value:function(){var e=Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new m.keyStores.BrowserLocalStorageKeyStore,e.next=3,m.connect(Object.assign({deps:{keyStore:t}},_));case 3:n=e.sent,this._near.archivalConnection=m.Connection.fromConfig({networkId:_.networkId,provider:{type:"JsonRpcProvider",args:{url:_.archivalNodeUrl}},signer:{type:"InMemorySigner",keyStore:t}}),this._near.keyStore=t,this._near.near=n,this._near.walletConnection=new m.WalletConnection(n,_.contractName),this._near.accountId=this._near.walletConnection.getAccountId(),this._near.account=this._near.walletConnection.account(),this._near.berryclub=new m.Account(this._near.archivalConnection,"berryclub.ek.near"),this._near.contract=new m.Contract(this._near.account,_.contractName,{viewMethods:["get_account","get_num_accounts","get_accounts","get_num_cards","get_top","get_rating","get_trade_data","get_card_info","get_account_cards"],changeMethods:["register_account","vote","buy_card"]});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestSignIn",value:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),"Berry Cards",e.next=4,this._near.walletConnection.requestSignIn(_.contractName,"Berry Cards");case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"logOut",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._near.walletConnection.signOut(),this._near.accountId=null,this.setState({signedIn:!!this._accountId,signedAccountId:this._accountId});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"popRequest",value:function(e){var t=this.state.requests.slice(1);this.setState({requests:t},e)}},{key:"addRequest",value:function(e,t){var n=this.state.requests.slice(0);n.push(e),this.setState({requests:n},t)}},{key:"addRecentCard",value:function(e){var t=this.state.recentCards.slice(0),n=t.indexOf(e);-1!==n&&t.splice(n,1),t.unshift(e),t=t.slice(0,5),b.a.set(this._near.lsKeyRecentCards,t),this.setState({recentCards:t})}},{key:"refreshAllowance",value:function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("You're out of access key allowance. Need sign in again to refresh it"),e.next=3,this.logOut();case 3:return e.next=5,this.requestSignIn();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(i.a)({_near:this._near,updateState:function(t,n){return e.setState(t,n)},popRequest:function(t){return e.popRequest(t)},addRequest:function(t,n){return e.addRequest(t,n)},addRecentCard:function(t){return e.addRecentCard(t)},refreshAllowance:function(){return e.refreshAllowance()}},this.state);this.state.connected&&this.state.signedIn&&this.state.signedAccountId;return r.a.createElement("div",{className:"App"},r.a.createElement("a",{className:"github-fork-ribbon right-bottom fixed",href:"https://github.com/evgenykuzyakov/hexland","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub"},"Fork me on GitHub"),r.a.createElement(g.a,t))}}]),n}(r.a.Component);c.a.render(r.a.createElement(w,null),document.getElementById("root"))},87:function(e,t,n){"use strict";(function(e){var a=n(0),r=n.n(a),o=n(91),c=n(33),i=n(14),s=(n(177),n(1)),u=n.n(s),l=n(9),d=n(88),f=n(89),h=null,v=Math.sqrt(3)/2,m=2*v,p=v,b={pos:[0,0,1]},g=function(t){var n=e.from(t,"base64");if(404!==n.length)throw new Error("Unexpected encoded line length");for(var a=[],r=4;r<n.length;r+=8){var o=n.readUInt32LE(r);a.push(o)}return a};function _(){return(_=Object(i.a)(r.a.mark((function t(n,a){var c,i,s,u,l,d;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={lines:Object(o.a)(Array(50).keys())},t.next=3,n.connection.provider.query({request_type:"call_function",block_id:a,finality:a?void 0:"optimistic",account_id:n.accountId,method_name:"get_lines",args_base64:e.from(JSON.stringify(c),"utf8").toString("base64")});case 3:return i=t.sent,s=i.result&&i.result.length>0&&JSON.parse(e.from(i.result).toString()),u=s.map(g),l=new Uint8ClampedArray(1e4),d=0,u.forEach((function(e,t){for(var n=e.length,a=0;a<n;a++){var r=e[a];l[d]=r>>16&255,l[d+1]=r>>8&255,l[d+2]=255&r,l[d+3]=255,d+=4}})),t.abrupt("return",new ImageData(l,50));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(e,t){var n=l.createProgramInfo(t,[d.a,f.a]),a={a_position:[-v-v/2,.75,0,v-v/2,.75,0,0-v/2,-.75,0,v-v/2,.75,0,2*v-v/2,-.75,0,0-v/2,-.75,0],a_texcoord:[0,0,1,0,0,1,1,0,1,1,0,1],a_ab:{numComponents:2,data:[-.5,-.5,2047.5,-.5,-.5,2047.5,2047.5,-.5,2047.5,2047.5,-.5,2047.5]}},r=l.createBufferInfoFromArrays(t,a),o=document.createElement("canvas");o.width=2048,o.height=2048;var c=o.getContext("2d");c.clearRect(0,0,2048,2048);var i=l.createTextures(t,{fromCanvas:{src:o,mag:t.NEAREST,min:t.NEAREST,wrap:t.CLAMP_TO_EDGE}}),s=function(e){return Math.floor(Math.random()*(2048-e))},u=setInterval((function(){(function(e,t){return _.apply(this,arguments)})(e,22e6+Math.floor(1e7*Math.random())).then((function(e){for(var n=0;n<10;++n)c.putImageData(e,s(50),s(50));c.fillStyle="rgba(0, 0, 0, 0)",c.fillRect(0,0,1,1),l.setTextureFromElement(t,i.fromCanvas,o)})).catch((function(e){console.log(e)}))}),100);setTimeout((function(){clearInterval(u)}),6e4),requestAnimationFrame((function e(a){l.resizeCanvasToDisplaySize(t.canvas),l.bindFramebufferInfo(t,null),t.viewport(0,0,t.canvas.width,t.canvas.height);var o={resolution:[t.canvas.width,t.canvas.height],texSize:[2047,2047],pos:b.pos,u_diffuse:i.fromCanvas};t.useProgram(n.program),l.setBuffersAndAttributes(t,n,r),l.setUniforms(n,o),l.drawBufferInfo(t,r),requestAnimationFrame(e)}))}t.a=function(e){var t=Object(s.useRef)(null),n=Object(s.useState)(null),a=Object(c.a)(n,2),r=a[0],o=a[1],i=Object(s.useState)({a:0,b:0,zoom:1,aspect:1}),l=Object(c.a)(i,2),d=l[0],f=l[1],v=Object(s.useState)({a:0,b:0}),g=Object(c.a)(v,2),_=g[0],y=g[1],x=Object(s.useCallback)((function(){var e=d.aspect,t=d.zoom,n=e/t/1.5/2,a=(1/t/2-n*p)/m;d.a,d.b;Object.assign(b,{pos:[d.a,d.b,t]})}),[r,d,_]);Object(s.useEffect)((function(){r&&x()}),[_,d,r,x]);var C=e._near.berryclub;return Object(s.useEffect)((function(){if(t.current&&C){var e=t.current.getContext("webgl");o(e),w(C,e),t.current.addEventListener("mousemove",(function(e){var t=e.clientX,n=e.clientY,a=e.target.getBoundingClientRect(),r=(e.clientX-a.x)/a.width-.5,o=((e.clientY-a.y)/a.width-a.height/a.width*.5)/1.5;if(y({a:(r-o*p)/m,b:o}),h){var c=(t-h.x)/a.width,i=(n-h.y)/a.width/1.5,s=(c-i*p)/m;f((function(e){return{a:e.a-s/e.zoom,b:e.b-i/e.zoom,zoom:e.zoom,aspect:e.aspect}}))}h=1&e.buttons?{x:t,y:n}:null})),t.current.addEventListener("wheel",(function(e){e.preventDefault();var t=e.target.getBoundingClientRect(),n=(e.clientX-t.x)/t.width-.5,a=((e.clientY-t.y)/t.width-t.height/t.width*.5)/1.5,r=(n-a*p)/m;f((function(t){var n=Math.max(1/64,t.zoom*Math.exp(.001*-e.deltaY)),o=t.a+r/t.zoom,c=t.b+a/t.zoom;return{a:o-r/n,b:c-a/n,zoom:n,aspect:t.aspect}}))}));var n=function(){var n=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;t.current.width=a*n,t.current.height=r*n,f((function(e){return Object.assign({},e,{aspect:r/a})}))};window.addEventListener("resize",n),n()}}),[t,C]),u.a.createElement("div",null,u.a.createElement("canvas",{ref:t,className:"canvas",width:640}))}}).call(this,n(8).Buffer)},88:function(e,t,n){"use strict";t.a="\nconst float Sq3 = sqrt(3.0) / 2.0;\nconst mat2 D = mat2(Sq3 * 2.0, Sq3, 0.0, -1.5);\n\nuniform vec2 resolution;\nuniform vec3 pos;\n\nattribute vec4 a_position;\nattribute vec2 a_texcoord;\nattribute vec2 a_ab;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_ab;\n\nvoid main() {\n  gl_Position = vec4((a_position.xy - pos.xy * D) * vec2(2.0, 2.0 * resolution.x / resolution.y) * pos.z, a_position.zw);\n  v_texCoord = a_texcoord;\n  v_ab = a_ab;\n}\n"},89:function(e,t,n){"use strict";t.a="\nprecision highp float;\n\nconst float Sq3 = sqrt(3.0) / 2.0;\nconst mat2 D = mat2(Sq3 * 2.0, Sq3, 0.0, -1.5);\n\nuniform vec3 color;\nuniform sampler2D u_diffuse;\nuniform vec2 texSize;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_ab;\n\nfloat d(vec2 p) {\n  vec2 dx = (p - v_ab) * D;\n  return dot(dx, dx);\n}\n\nvec3 mind(vec3 a, vec2 b)\n{\n  float db = d(b); \n  return mix(vec3(b, db), a, step(a.z, db));\n}\n\nvoid main() {\n  vec2 fab = floor(v_ab);\n  vec3 best = vec3(fab, d(fab));\n  best = mind(best, fab + vec2(1.0, 0.0));\n  best = mind(best, fab + vec2(0.0, 1.0));\n  best = mind(best, fab + vec2(1.0, 1.0));\n  \n  vec4 diffuseColor = texture2D(u_diffuse, best.xy / texSize);\n  if (diffuseColor.w < 1.0) {\n    discard;\n  }\n  gl_FragColor = diffuseColor;\n}\n"},94:function(e,t,n){e.exports=n(178)},99:function(e,t,n){}},[[94,1,2]]]);
//# sourceMappingURL=main.a9dcfe88.chunk.js.map