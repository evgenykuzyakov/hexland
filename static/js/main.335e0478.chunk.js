(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{110:function(t,e,n){},111:function(t,e,n){},116:function(t,e){},124:function(t,e){},140:function(t,e){},142:function(t,e){},169:function(t,e,n){},172:function(t,e,n){"use strict";n.r(e);var a=n(1),r=n.n(a),c=n(81),o=n.n(c),i=(n(92),n(85)),s=n(0),u=n.n(s),l=n(21),d=n(82),h=n(83),f=n(86),g=n(84),p=(n(44),n(109),n(110),n(111),n(22)),v=n(30),b=(n(169),null),m=Math.sqrt(3)/2,w=2*m,_=m;function y(t,e,n,a,r){t.fillStyle=r,t.beginPath(),t.moveTo(e,n-a),t.lineTo(e-m*a,n-a/2),t.lineTo(e-m*a,n+a/2),t.lineTo(e,n+a),t.lineTo(e+m*a,n+a/2),t.lineTo(e+m*a,n-a/2),t.fill()}var k=function(t){var e=Object(a.useRef)(null),n=Object(a.useState)(null),c=Object(v.a)(n,2),o=c[0],i=c[1],s=Object(a.useState)({a:0,b:0,zoom:1/30,aspect:1}),u=Object(v.a)(s,2),l=u[0],d=u[1],h=Object(a.useState)({a:0,b:0}),f=Object(v.a)(h,2),g=f[0],p=f[1],m=Object(a.useCallback)((function(){var t=l.aspect,e=l.zoom,n=1/e/w,a=t/e/1.5,r=t/e/1.5/2,c=(1/e/2-r*_)/w,i=l.a-c,s=l.b-r,u=Math.floor(i),d=Math.ceil(i+n),h=Math.floor(s),f=Math.floor(s+a+1);o.clearRect(0,0,1,t),o.font="".concat(e/3,"px serif"),o.textAlign="center",o.textBaseline="middle";for(var p=h;p<=f;++p)for(var v=u;v<=d;++v){var b=v-Math.floor((p-h)/2);y(o,((p-s)*_+(b-i)*w)*e,(1.5*(p-s)+0*(b-i))*e,e,"rgb(".concat((16*b%256+256)%256,", ").concat((16*p%256+256)%256,",").concat(((b+13+17*p)%256+256)%256,")"))}if(g){for(var m=function(t,e){var n=1.5*(e-x)+0*(t-k),a=(e-x)*_+(t-k)*w;return a*a+n*n},k=l.a+g.a/e,x=l.b+g.b/e,C=Math.trunc(k),O=Math.trunc(x),S=null,R=10,j=-1;j<2;++j)for(var I=-1;I<2;++I){var q=C+j,N=O+I,E=m(q,N);E<R+1e-9&&(S={a:q,b:N},R=E)}k=S.a,x=S.b,y(o,((x-s)*_+(k-i)*w)*e,(1.5*(x-s)+0*(k-i))*e,e,"rgba(0, 0, 0, 0.25)")}}),[o,l,g]);return Object(a.useEffect)((function(){o&&m()}),[g,l,o,m]),Object(a.useEffect)((function(){if(e.current){var t=e.current.getContext("2d");i(t),e.current.addEventListener("mousemove",(function(t){var e=t.clientX,n=t.clientY,a=t.target.getBoundingClientRect(),r=(t.clientX-a.x)/a.width-.5,c=((t.clientY-a.y)/a.width-a.height/a.width*.5)/1.5;if(p({a:(r-c*_)/w,b:c}),b){var o=(e-b.x)/a.width,i=(n-b.y)/a.width/1.5,s=(o-i*_)/w;d((function(t){return{a:t.a-s/t.zoom,b:t.b-i/t.zoom,zoom:t.zoom,aspect:t.aspect}}))}b=1&t.buttons?{x:e,y:n}:null})),e.current.addEventListener("wheel",(function(t){t.preventDefault();var e=t.target.getBoundingClientRect(),n=(t.clientX-e.x)/e.width-.5,a=((t.clientY-e.y)/e.width-e.height/e.width*.5)/1.5,r=(n-a*_)/w;d((function(e){var n=Math.max(1/256,e.zoom*Math.exp(.001*-t.deltaY)),c=e.a+r/e.zoom,o=e.b+a/e.zoom;return{a:c-r/n,b:o-a/n,zoom:n,aspect:e.aspect}}))}));var n=function(){var n=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;e.current.width=a*n,e.current.height=r*n,t.scale(e.current.width,e.current.width),d((function(t){return Object.assign({},t,{aspect:r/a})}))};window.addEventListener("resize",n),n()}}),[e]),r.a.createElement("div",null,r.a.createElement("canvas",{ref:e,className:"canvas",width:640}))},x=n(42),C=n.n(x),O="berry.cards"===window.location.hostname?{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",archivalNodeUrl:"https://rpc.mainnet.internal.near.org",contractName:"cards.berryclub.ek.near",walletUrl:"https://wallet.near.org"}:{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",archivalNodeUrl:"https://rpc.testnet.internal.near.org",contractName:"dev-1614796345972-8721304",walletUrl:"https://wallet.testnet.near.org"},S=function(t){Object(f.a)(n,t);var e=Object(g.a)(n);function n(t){var a;return Object(d.a)(this,n),(a=e.call(this,t))._near={},a._near.lsKey=O.contractName+":v01:",a._near.lsKeyRecentCards=a._near.lsKey+"recentCards",a.state={connected:!1,isNavCollapsed:!0,account:null,requests:null,recentCards:C.a.get(a._near.lsKeyRecentCards)||[]},a._initNear().then((function(){a.setState({signedIn:!!a._near.accountId,signedAccountId:a._near.accountId,connected:!0})})),a}return Object(h.a)(n,[{key:"_initNear",value:function(){var t=Object(l.a)(u.a.mark((function t(){var e,n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new p.keyStores.BrowserLocalStorageKeyStore,t.next=3,p.connect(Object.assign({deps:{keyStore:e}},O));case 3:n=t.sent,this._near.keyStore=e,this._near.near=n,this._near.walletConnection=new p.WalletConnection(n,O.contractName),this._near.accountId=this._near.walletConnection.getAccountId(),this._near.account=this._near.walletConnection.account(),this._near.contract=new p.Contract(this._near.account,O.contractName,{viewMethods:["get_account","get_num_accounts","get_accounts","get_num_cards","get_top","get_rating","get_trade_data","get_card_info","get_account_cards"],changeMethods:["register_account","vote","buy_card"]});case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"requestSignIn",value:function(){var t=Object(l.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e&&e.preventDefault(),"Berry Cards",t.next=4,this._near.walletConnection.requestSignIn(O.contractName,"Berry Cards");case 4:return t.abrupt("return",!1);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"logOut",value:function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._near.walletConnection.signOut(),this._near.accountId=null,this.setState({signedIn:!!this._accountId,signedAccountId:this._accountId});case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"popRequest",value:function(t){var e=this.state.requests.slice(1);this.setState({requests:e},t)}},{key:"addRequest",value:function(t,e){var n=this.state.requests.slice(0);n.push(t),this.setState({requests:n},e)}},{key:"addRecentCard",value:function(t){var e=this.state.recentCards.slice(0),n=e.indexOf(t);-1!==n&&e.splice(n,1),e.unshift(t),e=e.slice(0,5),C.a.set(this._near.lsKeyRecentCards,e),this.setState({recentCards:e})}},{key:"refreshAllowance",value:function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return alert("You're out of access key allowance. Need sign in again to refresh it"),t.next=3,this.logOut();case 3:return t.next=5,this.requestSignIn();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=Object(i.a)({_near:this._near,updateState:function(e,n){return t.setState(e,n)},popRequest:function(e){return t.popRequest(e)},addRequest:function(e,n){return t.addRequest(e,n)},addRecentCard:function(e){return t.addRecentCard(e)},refreshAllowance:function(){return t.refreshAllowance()}},this.state);this.state.connected&&this.state.signedIn&&this.state.signedAccountId;return r.a.createElement("div",{className:"App"},r.a.createElement("a",{className:"github-fork-ribbon right-bottom fixed",href:"https://github.com/evgenykuzyakov/berry-hot","data-ribbon":"Fork me on GitHub",title:"Fork me on GitHub"},"Fork me on GitHub"),r.a.createElement(k,e))}}]),n}(r.a.Component);o.a.render(r.a.createElement(S,null),document.getElementById("root"))},87:function(t,e,n){t.exports=n(172)},92:function(t,e,n){}},[[87,1,2]]]);
//# sourceMappingURL=main.335e0478.chunk.js.map